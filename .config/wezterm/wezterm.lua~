-- setup configuration
local wezterm = require 'wezterm'
local config = wezterm.config_builder()
local act = wezterm.action

-- LEADER ã®è¨­å®š
config.leader = {
  key = "p",
  mods = "CTRL",
  timeout_milliseconds = 1000,
}

config.keys = {
  -- workspace ã‚’é¸æŠã™ã‚‹
  {
    key = 's',
    mods = 'LEADER|CTRL',
    action = act.ShowLauncherArgs { flags = 'WORKSPACES', title = "Select workspace" }
  },
  -- ç¾åœ¨ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹ workspace ã®åå‰ã‚’å¤‰æ›´ã™ã‚‹
  {
    key = "r",
    mods = 'LEADER|CTRL',
    action = act.PromptInputLine {
      description = '(wezterm) Set workspace title: ',
      action = wezterm.action_callback(function(win, pane, line)
        if line then
          wezterm.mux.rename_workspace(
            wezterm.mux.get_active_workspace(),
            line
          )
        end
      end)
    }
  },
  -- åå‰ã‚’ã¤ã‘ã¦ workspace ã‚’ä½œæˆã™ã‚‹
  {
    key = 'c',
    mods = 'LEADER|CTRL',
    action = act.PromptInputLine {
      description = "(wezterm) Create new workspace:",
      action = wezterm.action_callback(function(window, pane, line)
        if line then
          window:perform_action(
            act.SwitchToWorkspace {
              name = line,
            },
            pane
          )
        end
      end),
    },
  },
  { key = 'n', mods = 'LEADER|CTRL', action = act.SwitchWorkspaceRelative(1) },
  { key = 'p', mods = 'LEADER|CTRL', action = act.SwitchWorkspaceRelative(-1) },
}

-- èµ·å‹•æ™‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã®è¨­å®šï¼ˆåˆæœŸè¨­å®šãŒå°ã•ã™ãã‚‹ï¼‰
config.initial_cols = 150
config.initial_rows = 60

-- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã„ã˜ã‚‹ã¨è‡ªå‹•ã§ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒèµ°ã‚‹
config.automatically_reload_config = true

-- ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒè¨­å®š
config.color_scheme = 'Tokyo Night'

-- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã®è¨­å®š
config.font_size = 12.0

-- æ—¥æœ¬èªå…¥åŠ›è¨­å®šï¼ˆ?ï¼‰
config.use_ime = true

-- é€æ˜åº¦ 0=é€æ˜ 1=ä¸é€æ˜
config.window_background_opacity = 0.75

-- ã¼ã‹ã—
config.macos_window_background_blur = 20

-- ã‚¿ãƒ–ãŒä¸€ã¤ã®å ´åˆã®ã¿ã€ã‚¿ãƒ–ãƒãƒ¼ã®éè¡¨ç¤º
config.hide_tab_bar_if_only_one_tab = true

-- ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã®å‰Šé™¤
config.window_decorations = "RESIZE"

-- ã‚¿ãƒ–ãƒãƒ¼ã‚’é€æ˜ã«ã™ã‚‹
config.window_frame = {
  inactive_titlebar_bg = "none",
  active_titlebar_bg = "none",
}

-- ã‚¿ãƒ–ãƒãƒ¼ã‚’èƒŒæ™¯ã¨åŒè‰²ã«ã™ã‚‹
config.window_background_gradient = {
  colors = { "#000000" },
}

-- ãƒ—ãƒ©ã‚¹ãƒœã‚¿ãƒ³ã®å‰Šé™¤
config.show_new_tab_button_in_tab_bar = false

-- ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–ã«è‰²ã‚’ã¤ã‘ã‚‹
wezterm.on(
  "format-tab-title",
  function(tab, tabs, panes, config, hover, max_width)
    local background = "#5c6d74"
    local foreground = "#ffffff"

    if tab.is_active then
      background = "#ae8b2d"
      foreground = "#ffffff"
    end

    local title = "   " .. wezterm.truncate_right(tab.active_pane.title, max_width - 1) .. "   "

    return {
      { Background = { Color = background } },
      { Foreground = { Color = foreground } },
      { Text = title },
    }
  end
)

-- éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒšã‚¤ãƒ³ã«é–¢ã—ã¦ã¯æš—ã‚ã«è¨­å®šã™ã‚‹ğŸ
config.inactive_pane_hsb = {
  saturation = 0.75,
  brightness = 0.6,
}

-- å¢ƒç•Œç·šã®è‰²ã‚’å¼·èª¿ã™ã‚‹
config.colors = {
  split = "#a0a0a0"
}

config.force_reverse_video_cursor = true

config.cursor_blink_rate = 500

return config
